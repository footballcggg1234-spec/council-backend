<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPK26 Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: { colors: { primary: '#9F1239', gold: '#F59E0B' }, fontFamily: { sans: ['Sarabun', 'sans-serif'] } }
            }
        }
    </script>
    <style>
        body { background: #F8FAFC; }
        .glass { background: rgba(255,255,255,0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.8); }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px 16px; border-radius: 16px; color: #64748b; font-weight: 600; transition: 0.2s; }
        .nav-item:hover, .nav-item.active { background: #fff1f2; color: #9F1239; }
    </style>
</head>
<body class="flex h-screen overflow-hidden">
    
    <aside class="hidden lg:flex w-64 bg-white/80 backdrop-blur p-6 flex-col justify-between border-r h-full">
        <div>
            <div class="flex items-center gap-3 mb-10"><div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center text-white text-xl"><i class="fas fa-university"></i></div><h1 class="font-black text-xl text-slate-800">RPK<span class="text-primary">26</span></h1></div>
            <nav class="space-y-1">
                <a href="index.html" class="nav-item active"><i class="fas fa-home w-6"></i> หน้าแรก</a>
                <a href="election.html" class="nav-item text-blue-600 bg-blue-50"><i class="fas fa-vote-yea w-6"></i> เลือกตั้ง</a>
                <a href="weekly-report.html" class="nav-item"><i class="fas fa-chart-pie w-6"></i> รายงานคะแนน</a>
                <a href="suggestion.html" class="nav-item"><i class="fas fa-envelope w-6"></i> ร้องเรียน</a>
            </nav>
        </div>
        <a href="login.html" class="flex items-center gap-3 p-4 bg-white rounded-2xl border shadow-sm"><div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center"><i class="fas fa-user-shield text-gray-500"></i></div><div class="text-sm font-bold">Admin Login</div></a>
    </aside>

    <main class="flex-1 overflow-y-auto p-4 lg:p-8 relative">
        <div class="max-w-5xl mx-auto">
            
            <div class="lg:hidden flex justify-between items-center mb-6">
                <h1 class="text-2xl font-black text-slate-800">หน้าแรก</h1>
                <a href="login.html" class="w-10 h-10 bg-white rounded-full shadow flex items-center justify-center text-primary"><i class="fas fa-user"></i></a>
            </div>

            <a href="election.html" class="block w-full bg-gradient-to-r from-blue-900 to-indigo-800 rounded-[32px] p-6 lg:p-8 text-white relative overflow-hidden shadow-xl mb-8 group hover:scale-[1.01] transition duration-300">
                <div class="relative z-10 flex flex-col md:flex-row items-center justify-between gap-6">
                    <div>
                        <div class="inline-block bg-yellow-400 text-black text-xs font-bold px-3 py-1 rounded-full mb-3 animate-pulse">เปิดลงคะแนนแล้ว!</div>
                        <h2 class="text-3xl lg:text-4xl font-black mb-2">ELECTION 2026</h2>
                        <p class="text-blue-200">1 สิทธิ์ 1 เสียง ร่วมเลือกประธานนักเรียนคนใหม่</p>
                    </div>
                    <button class="bg-white/10 backdrop-blur px-6 py-3 rounded-xl border border-white/20 font-bold group-hover:bg-white group-hover:text-blue-900 transition flex items-center gap-2">
                        เข้าคูหา <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </a>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                <div class="bg-white p-5 rounded-3xl border-l-4 border-blue-500 shadow-sm"><div class="text-xs font-bold text-gray-400 mb-2">ออกกาย</div><div id="podium-exercise" class="h-20 flex items-end justify-center gap-2">Loading...</div></div>
                <div class="bg-white p-5 rounded-3xl border-l-4 border-purple-500 shadow-sm"><div class="text-xs font-bold text-gray-400 mb-2">หอนอน</div><div id="podium-dorm" class="h-20 flex items-end justify-center gap-2">Loading...</div></div>
                <div class="bg-white p-5 rounded-3xl border-l-4 border-green-500 shadow-sm"><div class="text-xs font-bold text-gray-400 mb-2">ห้องเรียน</div><div id="podium-classroom" class="h-20 flex items-end justify-center gap-2">Loading...</div></div>
            </div>

            <h3 class="text-lg font-bold text-gray-800 mb-4">ข่าวประชาสัมพันธ์</h3>
            <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        
        </div>
    </main>

    <nav class="lg:hidden fixed bottom-4 left-4 right-4 bg-gray-900/90 backdrop-blur text-white p-3 rounded-2xl shadow-2xl z-50 flex justify-between px-6">
        <a href="index.html" class="text-primary"><i class="fas fa-home text-xl"></i></a>
        <a href="election.html"><i class="fas fa-vote-yea text-xl"></i></a>
        <a href="suggestion.html"><i class="fas fa-plus-circle text-2xl text-primary"></i></a>
        <a href="weekly-report.html"><i class="fas fa-chart-pie text-xl"></i></a>
        <a href="team.html"><i class="fas fa-users text-xl"></i></a>
    </nav>

    <script>
        const API = '/api';
        async function init() {
            try {
                const [s, n] = await Promise.all([fetch(`${API}/scores`), fetch(`${API}/news`)]);
                const scores = await s.json();
                renderPodium('exercise', scores.filter(d=>d.type==='dorm'), 'bg-blue-500');
                renderPodium('dorm', scores.filter(d=>d.type==='dorm'), 'bg-purple-500');
                renderPodium('classroom', scores.filter(d=>d.type==='classroom'), 'bg-green-500');
                
                const news = await n.json();
                document.getElementById('news-container').innerHTML = news.length ? news.map(n=>`<div class="bg-white p-4 rounded-2xl shadow-sm"><h4 class="font-bold text-gray-800">${n.title}</h4><p class="text-sm text-gray-500 truncate">${n.content||''}</p></div>`).join('') : '<p class="text-gray-400 col-span-2 text-center">ยังไม่มีข่าว</p>';
            } catch(e) { console.error(e); }
        }
        function renderPodium(id, data, color) {
            const key = id==='classroom'?'points_class':(id==='exercise'?'points_exercise':'points_dorm');
            data.sort((a,b)=>(b[key]||0)-(a[key]||0));
            const top = data[0];
            document.getElementById(`podium-${id}`).innerHTML = top ? `<div class="w-full text-center"><div class="text-3xl font-black ${color.replace('bg','text')}">${top[key]||0}</div><div class="text-xs truncate">${top.name}</div></div>` : '-';
        }
        init();
    </script>
</body>
</html>